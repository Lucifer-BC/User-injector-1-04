# üß† User Injector - Projet AD Lab

Projet de d√©ploiement automatique d'un environnement Active Directory complet via PowerShell, con√ßu pour un lab ou une d√©monstration technique. Il repose sur un jeu de comptes simul√©s g√©n√©r√©s avec Mockaroo.

---

## üìÅ Arborescence du projet

```bash
User-injector-1-04/
‚îú‚îÄ‚îÄ README.md                 # Ce fichier
‚îú‚îÄ‚îÄ deploy-lab.ps1            # Script principal d'automatisation
‚îú‚îÄ‚îÄ data/                     # Donn√©es utilisateurs CSV
‚îÇ   ‚îú‚îÄ‚îÄ users.csv             # 200 utilisateurs standards (Mockaroo)
‚îÇ   ‚îî‚îÄ‚îÄ admins.csv            # 10 comptes admin (Mockaroo)
‚îî‚îÄ‚îÄ scripts/                  # Scripts PowerShell li√©s au lab
    ‚îú‚îÄ‚îÄ install-ad.ps1        # Installation AD et cr√©ation du domaine "Loutrel.eu"
    ‚îú‚îÄ‚îÄ init-ous.ps1          # Cr√©ation des OU : CEFIM Tours / USERS / ADMINS
    ‚îú‚îÄ‚îÄ create-users.ps1      # Injection des utilisateurs standards
    ‚îú‚îÄ‚îÄ create-admins.ps1     # Injection des utilisateurs admins + ajout groupe "Administrateurs"
    ‚îî‚îÄ‚îÄ check-users.ps1       # Script de v√©rification final
```

---

## üöÄ D√©roulement du projet

### 1. üìã Pr√©requis

| √âl√©ment | Description |
|--------|-------------|
| üñ•Ô∏è Machine | VM Windows Server 2022 (ou 2019) |
| üîß VMware Tools | Doit √™tre install√© et √† jour |
| üîå IP Fixe | La machine doit avoir une IP statique (v√©rifi√©e par script) |
| üì¶ R√¥le ADDS | Pr√©install√© ou install√© automatiquement |
| üìÇ Acc√®s aux fichiers | Le dossier partag√© `User-injector-1-04` doit √™tre mont√© dans un lecteur (ex : `Z:`) |
| üîê Mot de passe | Un mot de passe vous sera demand√© pour le compte admin du domaine |

### 2. üì¶ Lancement initial (cr√©ation du domaine)

Ouvre **PowerShell en tant qu‚Äôadministrateur**, puis ex√©cute :

```powershell
Set-ExecutionPolicy Unrestricted -Scope Process
Z:
Unblock-File .\deploy-lab.ps1
.\deploy-lab.ps1
```

Ce script :
- V√©rifie l'IP
- Installe le r√¥le ADDS
- Promeut le serveur en tant que DC (domaine `Loutrel.eu`)
- ‚ùó Red√©marre automatiquement le serveur apr√®s cette √©tape

### 3. üîÅ Reprise apr√®s red√©marrage

**Reconnecte-toi**, puis relance ces commandes pour ex√©cuter la suite :

```powershell
Set-ExecutionPolicy Unrestricted -Scope Process
Z:
Unblock-File .\deploy-lab.ps1
.\deploy-lab.ps1
```

Cela va encha√Æner :
- La cr√©ation des OU
- L'injection des utilisateurs
- La v√©rification finale

### 4. üß™ Mode Simulation (Dry Run)

Pour tester **sans cr√©er d‚Äôutilisateurs**, tu peux ajouter le param√®tre `-DryRun:$true` :

```powershell
.\deploy-lab.ps1 -DryRun:$true
```

### 5. ‚úÖ V√©rification finale

Le script `check-users.ps1` v√©rifie que :
- Les OU existent bien
- Il y a 200 utilisateurs dans USERS
- Il y a 10 comptes dans ADMINS
- Les comptes ADMINS sont membres du groupe "Administrateurs"

Un fichier `check-results.log` est g√©n√©r√© automatiquement avec le statut final.

---

## üß™ Tests r√©alis√©s

- [x] Installation automatique ADDS
- [x] Red√©marrage du contr√¥leur de domaine
- [x] Cr√©ation s√©curis√©e d‚ÄôOU imbriqu√©es
- [x] Injection de 200 utilisateurs standards
- [x] Injection de 10 admins + ajout groupe Administrateurs
- [x] V√©rification finale automatis√©e
- [x] Gestion du mode DryRun pour tous les scripts

---

## üôã Auteur

Projet r√©alis√© par **Lucifer / Lucie ü¶¶** dans le cadre d‚Äôun TP TSSR - scripting PowerShell et GitHub avec VSCode.

> Ce projet a √©t√© pens√© comme un kit de d√©ploiement rapide pour tout environnement lab AD.
